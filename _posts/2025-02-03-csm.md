---
layout: post
title: "AUTOSAR Crypto stack #2 CSM"
date:   2025-02-03
categories: [Automotive]
tags: [autosar, security, immediate]
last_modified_at: 2025-07-08
references:
  - title:
    url:
---

## Let's get started with the highest module of common crypto stack - CSM (Crypto Service Manager).

### 1. CSM functionalities

The CSM controls the concurrent access of one or more clients to one or more synchronous/asynchronous cryptographic services.

It offers prioritize queues to manage jobs that could not directly be processed by the dedicated CRYPTO.

The functionalities provided by CSM cover the following areas:

 - Hash calculation.
 
 - Generation & verification for MAC (Message authentication code).

 - Digital signature generation & verification.
 
 - Encryption & decryption via symmetrical/asymmetrical algorithms.

 - Random number generation (pseudo/true).

 - Secure counter.

 - Key management operation.

 - ...

<figure>
  <img src="/assets/img/blogs/1.2/csminterface.png" alt="CSM interface">
  <figcaption>CSM's interface to adjacent modules</figcaption>
</figure>

Note: The CSM services are generic, which means it allows different applications to use the same service with different cryptographic algorithms.

### 2. CSM configuration 

These are some important parameters when developer configure CSM module:

 - CsmPrimitives: The primitives are configurations used to define a cryptographic operation. The main configurations include algorithm family, algorithm key length, data length, result length, processing mode (asynchronous/synchronous), key reference and more.

 - CsmJobs: Primitives are assigned to Jobs which in turn determine further attributes like priority, the correspond queue and key used fot the operation.

 - CsmKeys: These are references to keys present in [Crypto driver]({% post_url 2025-07-08-crypto-driver %}).

 - CsmQueues: CsmJobs are configured in queues according to configured job's priority, It also contain reference to [CryIf]({% post_url 2025-07-06cryif %}).